(function(){var b,i,j,a,d,e,k,f,h,g,c;d=require("fs");k=require("path");b=require("child_process");f=k.join(__dirname,"..");i=require("coffee-script-redux");a=k.join(f,"node_modules",".bin","coffee");e=k.join(f,""+process.argv[2]);h=k.join(f,""+process.argv[3]);c=[];if(!d.watch){console.error("fs.watch is not provided");process.exit(1)}g=function(l){return console.log(""+((new Date).toLocaleTimeString())+" - "+l)};j=function(l,m){return b.exec(""+a+" -j < "+(JSON.stringify(l))+" > "+(JSON.stringify(m)),function(n){return g("compiled "+(k.relative(f,l)))})};d.mkdir(e,function(){return d.readdir(h,function(p,o){var m,n,r,q,l;r=function(){var t,s;s=k.join(h,m);t=k.join(e,""+(k.basename(m,".coffee"))+".js");return j(s,t)};for(q=0,l=o.length;q<l;q++){m=o[q];r()}n=function(){var t,u,s;console.log("watch",h);for(u=0,s=c.length;u<s;u++){t=c[u];t.close()}return d.readdir(h,function(z,y){var x,v,w;console.log(y);w=[];for(x=0,v=y.length;x<v;x++){m=y[x];w.push((function(){var B,A;A=k.join(h,m);B=k.join(e,""+(k.basename(m,".coffee"))+".js");t=d.watch(A,function(D,C){console.log("starting...",D);if(D==="change"){return j(A,B)}});return c.push(t)})())}return w})};return n()})})}).call(this);