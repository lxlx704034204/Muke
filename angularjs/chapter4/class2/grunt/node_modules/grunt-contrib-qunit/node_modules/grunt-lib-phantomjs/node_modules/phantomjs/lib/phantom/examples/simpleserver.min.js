(function(){var b,d,a,c;c=require("system");if(c.args.length===1){console.log("Usage: simpleserver.coffee <portnumber>");phantom.exit(1)}else{b=c.args[1];d=require("webserver").create();a=d.listen(b,function(f,e){console.log("Request at "+new Date());console.log(JSON.stringify(f,null,4));e.statusCode=200;e.headers={Cache:"no-cache","Content-Type":"text/html"};e.write("<html>");e.write("<head>");e.write("<title>Hello, world!</title>");e.write("</head>");e.write("<body>");e.write("<p>This is from PhantomJS web server.</p>");e.write("<p>Request data:</p>");e.write("<pre>");e.write(JSON.stringify(f,null,4));e.write("</pre>");e.write("</body>");e.write("</html>");return e.close()});if(a){console.log("Web server running on port "+b)}else{console.log("Error: Could not create web server listening on port "+b);phantom.exit()}}}).call(this);