(function(){var b,d,a,c;b=void 0;d=void 0;a=void 0;c=require("system");if(c.args.length!==2){console.log("Usage: serverkeepalive.js <portnumber>");phantom.exit(1)}else{b=c.args[1];d=require("webserver").create();a=d.listen(b,{keepAlive:true},function(g,f){var e;console.log("Request at "+new Date());console.log(JSON.stringify(g,null,4));e=JSON.stringify(g,null,4);f.statusCode=200;f.headers={Cache:"no-cache","Content-Type":"text/plain",Connection:"Keep-Alive","Keep-Alive":"timeout=5, max=100","Content-Length":e.length};f.write(e);return f.close()});if(a){console.log("Web server running on port "+b)}else{console.log("Error: Could not create web server listening on port "+b);phantom.exit()}}}).call(this);