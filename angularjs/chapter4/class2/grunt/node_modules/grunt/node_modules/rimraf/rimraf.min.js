module.exports=rimraf;rimraf.sync=rimrafSync;var path=require("path");var fs=require("fs");var timeout=0;exports.EMFILE_MAX=1000;exports.BUSYTRIES_MAX=3;var isWindows=(process.platform==="win32");function rimraf(d,b){if(!b){throw new Error("No callback passed to rimraf()")}var a=0;rimraf_(d,function c(f){if(f){if(isWindows&&(f.code==="EBUSY"||f.code==="ENOTEMPTY")&&a<exports.BUSYTRIES_MAX){a++;var e=a*100;return setTimeout(function(){rimraf_(d,c)},e)}if(f.code==="EMFILE"&&timeout<exports.EMFILE_MAX){return setTimeout(function(){rimraf_(d,c)},timeout++)}if(f.code==="ENOENT"){f=null}}timeout=0;b(f)})}function rimraf_(b,a){fs.unlink(b,function(c){if(c){if(c.code==="ENOENT"){return a(null)}if(c.code==="EPERM"){return(isWindows)?fixWinEPERM(b,c,a):rmdir(b,c,a)}if(c.code==="EISDIR"){return rmdir(b,c,a)}}return a(c)})}function fixWinEPERM(b,c,a){fs.chmod(b,666,function(d){if(d){a(d.code==="ENOENT"?null:c)}else{fs.stat(b,function(e,f){if(e){a(e.code==="ENOENT"?null:c)}else{if(f.isDirectory()){rmdir(b,c,a)}else{fs.unlink(b,a)}}})}})}function fixWinEPERMSync(e,f,a){try{fs.chmodSync(e,666)}catch(d){if(d.code!=="ENOENT"){throw f}}try{var c=fs.statSync(e)}catch(b){if(b!=="ENOENT"){throw f}}if(c.isDirectory()){rmdirSync(e,f)}else{fs.unlinkSync(e)}}function rmdir(c,b,a){fs.rmdir(c,function(d){if(d&&(d.code==="ENOTEMPTY"||d.code==="EEXIST"||d.code==="EPERM")){rmkids(c,a)}else{if(d&&d.code==="ENOTDIR"){a(b)}else{a(d)}}})}function rmkids(b,a){fs.readdir(b,function(f,c){if(f){return a(f)}var e=c.length;if(e===0){return fs.rmdir(b,a)}var d;c.forEach(function(g){rimraf(path.join(b,g),function(h){if(d){return}if(h){return a(d=h)}if(--e===0){fs.rmdir(b,a)}})})})}function rimrafSync(a){try{fs.unlinkSync(a)}catch(b){if(b.code==="ENOENT"){return}if(b.code==="EPERM"){return isWindows?fixWinEPERMSync(a,b):rmdirSync(a,b)}if(b.code!=="EISDIR"){throw b}rmdirSync(a,b)}}function rmdirSync(b,a){try{fs.rmdirSync(b)}catch(c){if(c.code==="ENOENT"){return}if(c.code==="ENOTDIR"){throw a}if(c.code==="ENOTEMPTY"||c.code==="EEXIST"||c.code==="EPERM"){rmkidsSync(b)}}}function rmkidsSync(a){fs.readdirSync(a).forEach(function(b){rimrafSync(path.join(a,b))});fs.rmdirSync(a)};